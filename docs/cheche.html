---
layout: default
title: CheChe
parent: SheShe
nav_order: 6
---
<link rel="stylesheet" href="style.css">

<h1>CheChe</h1>

<pre><code>
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
from sheshe import CheChe

X, y = load_iris(return_X_y=True)
che = CheChe().fit(X, y)
che.plot_pairs(X, y, max_pairs=1, show_histograms=True)
plt.show()
</code></pre>
<p>Computes convex-hull frontiers for selected feature pairs and provides simple</p>
<p>2D visualisations. Useful for exploring decision boundaries or cluster shapes,</p>
<p>it can subsample points via <code>mapping_level</code> and plot frontiers per class or</p>
<p>for scalar score functions.</p>
<h2>Mathematical formulation</h2>
<p>For feature pair <code>(i,j)</code>, CheChe projects samples with <code>P_{ij}(x) = (x_i, x_j)</code>. QuickHull constructs the convex hull <code>H</code> of these projections.</p>
<p>The decision function outputs the negative distance from the projected point to the hull centroid: <code>-‖P_{ij}(x) - c_H‖</code>.</p>
<h2>Example</h2>
<pre><code class="language-python">
from sheshe import CheChe
cc = CheChe()
cc.fit(X, y)
cc.plot_pairs(X, show_histograms=True)
</code></pre>

<h2>Usage examples</h2>
<pre><code class="language-python">
from sheshe import CheChe

che = CheChe(random_state=0)
che.fit(X, y)                      # fit
che.fit_predict(X, y)              # fit_predict
che.fit(X, y).predict(X)           # predict
che.fit(X, y).predict_proba(X)     # predict_proba
che.fit(X, y).predict_regions(X)   # predict_regions
che.fit(X, y).decision_function(X) # decision_function
che.fit(X, y).save("che.joblib")   # save
CheChe.load("che.joblib")
</code></pre>
<h2>Additional examples</h2>
<pre><code class="language-python">
from sklearn.datasets import load_iris
from sheshe import CheChe

X, y = load_iris(return_X_y=True)
ch = CheChe().fit(
    X,
    y,
    feature_names=["sepal length", "sepal width", "petal length", "petal width"],
    mapping_level=2,  # use every other sample
)
ch.plot_pairs(X, class_index=0, show_histograms=True)
</code></pre>
<pre><code class="language-python">
from sklearn.linear_model import LogisticRegression

model = LogisticRegression(max_iter=200).fit(X, y)
CheChe().fit(X, y, score_model=model)

score_fn = lambda Z: model.predict_proba(Z)[:, 0]
CheChe().fit(X, score_fn=score_fn)
</code></pre>
<h2>Parameters</h2>
<ul>
<li><code>random_state</code> (<code>int</code> or <code>None</code>, default <code>None</code>): seed for reproducibility.
</li>
</ul>
<h3>Fit-time options</h3>
<p>The <code>fit</code> method accepts additional arguments mirroring the <code>ShuShu</code> API:</p>
<ul>
<li><code>score_fn</code> (callable, optional): scalar score function when <code>y</code> is not
 provided.
</li>
<li><code>feature_names</code> (<code>list[str]</code> or <code>None</code>): names for features.
</li>
<li><code>score_model</code> (estimator, optional): model used to derive class probabilities.
</li>
<li><code>score_fn_multi</code> (<code>callable</code>, optional): multi-class score function.
</li>
<li><code>score_fn_per_class</code> (<code>list[callable]</code>, optional): per-class score functions.
</li>
<li><code>max_pairs</code> (<code>int</code> or <code>None</code>, default <code>10</code>): maximum number of feature pairs
 to analyse.
</li>
<li><code>mapping_level</code> (<code>int</code> or <code>None</code>, default <code>None</code>): down-sampling level for
 frontier computation.
</li>
</ul>
<h2>Methods</h2>
<ul>
<li><code>fit(X, y=None, **kwargs)</code> – estimate 2D frontiers for feature pairs.
</li>
<li><code>fit_predict(X, y=None, **kwargs)</code> – fit the model and immediately return
 predictions.
</li>
<li><code>predict(X)</code> – assign region ids or class labels.
</li>
<li><code>predict_proba(X)</code> – return class probabilities in multiclass mode.
</li>
<li><code>predict_regions(X)</code> – DataFrame with labels and region ids.
</li>
<li><code>decision_function(X)</code> – negative distances to region centres.
</li>
<li><code>plot_pairs(X, class_index=None, feature_names=None, show_histograms=False)</code> – scatter plots with
 frontier overlays for stored pairs and optional marginal histograms.
</li>
<li><code>plot_classes(X, y, ...)</code> – plot frontiers for each class when in supervised
 mode.
</li>
</ul>
